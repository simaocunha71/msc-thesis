这段代码的问题在于，它使用了递归而不是迭代来计算从1到n的和。递归是一种通过函数调用自身来解决问题的方法，但是在这种情况下，迭代更简单且更有效率。

另外，这段代码中的for循环使用了i作为循环变量，但是i的初始值被设置为0，这可能会导致循环执行时i的值不正确。应该将i的初始值设置为1，以便从1开始计算和。

最后，这段代码中的sum_to_n函数没有处理n为负数的情况，如果n为负数，那么计算出的和将不正确。应该添加一个条件语句来处理n为负数的情况，例如返回0或其他适当的值。

修正后的代码如下：

```c++
#include<stdio.h>
using namespace std;
int sum_to_n(int n){
    int sum=0;
    for(int i=1;i<=n;i++){
        sum+=i;
    }
    return sum;
}
int main(){
    int n;
    scanf("%d",&n);
    printf("%d",sum_to_n(n));
    return 0;
}
```

这段代码使用迭代来计算从1到n的和，并且处理了n为负数的情况。